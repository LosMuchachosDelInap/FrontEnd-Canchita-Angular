<nav class="sidebar-nav">
  <!-- Información del usuario o botones de autenticación -->
  @if (isAuthenticated && currentUser) {
    <div class="user-section">
      <div class="user-avatar">
        <mat-icon>account_circle</mat-icon>
      </div>
      <div class="user-details">
        <span class="user-name">{{ getUserDisplayName() }}</span>
        <span class="user-role">{{ getUserRole() }}</span>
      </div>
      <button mat-icon-button (click)="logout(); closeSidenavPanel()" class="logout-button">
        <mat-icon>logout</mat-icon>
      </button>
    </div>
  }
  
  @if (!isAuthenticated) {
    <div class="auth-section">
      <button mat-button (click)="openLoginModal(); closeSidenavPanel()" class="auth-button login-button">
        <mat-icon>login</mat-icon>
        Iniciar Sesión
      </button>
      <button mat-button (click)="openRegisterModal(); closeSidenavPanel()" class="auth-button register-button">
        <mat-icon>person_add</mat-icon>
        Registrarse
      </button>
    </div>
  }
  
  <!-- Separador -->
  <mat-divider></mat-divider>
  
  <!-- Enlaces de navegación -->
  <div class="navigation-section">
    <!-- Enlaces para todos los usuarios -->
    @for (link of [
      { path: '/home', label: 'Inicio', icon: 'home', requiredRole: null }
    ]; track link.path) {
      <a mat-button [routerLink]="link.path" (click)="closeSidenavPanel()" class="nav-link">
        <mat-icon>{{ link.icon }}</mat-icon>
        {{ link.label }}
      </a>
    }
    
    <!-- Enlaces solo para usuarios autenticados -->
    @if (isAuthenticated) {
      <!-- Enlaces para reservas (disponible para todos los usuarios autenticados) -->
      @if (canReserveCancha()) {
        <a mat-button routerLink="/reservas" (click)="closeSidenavPanel()" class="nav-link">
          <mat-icon>sports_soccer</mat-icon>
          Reservar Canchas
        </a>
      }

      <!-- Ver mis reservas (disponible para todos los usuarios autenticados) -->
      @if (canViewReservations()) {
        <a mat-button routerLink="/dashboard/mis-reservas" (click)="closeSidenavPanel()" class="nav-link">
          <mat-icon>event_note</mat-icon>
          Mis Reservas
        </a>
      }

      <!-- Enlaces para administración (solo Dueño y Administrador) -->
      @if (canAccessAdmin()) {
        <mat-divider></mat-divider>
        <div class="section-header">
          <mat-icon>admin_panel_settings</mat-icon>
          Administración
        </div>
        
        <a mat-button routerLink="/admin/usuarios" (click)="closeSidenavPanel()" class="nav-link admin-link">
          <mat-icon>people</mat-icon>
          Gestión de Usuarios
        </a>
        
        <a mat-button routerLink="/admin/canchas" (click)="closeSidenavPanel()" class="nav-link admin-link">
          <mat-icon>sports_soccer</mat-icon>
          Gestión de Canchas
        </a>
        
        <a mat-button routerLink="/admin/reservas" (click)="closeSidenavPanel()" class="nav-link admin-link">
          <mat-icon>event</mat-icon>
          Gestión de Reservas
        </a>
      }

      <!-- Enlaces específicos para roles de Bar -->
      @if (canAccessBar()) {
        <mat-divider></mat-divider>
        <div class="section-header">
          <mat-icon>local_bar</mat-icon>
          Gestión de Bar
        </div>
        
        <a mat-button routerLink="/bar/productos" (click)="closeSidenavPanel()" class="nav-link bar-link">
          <mat-icon>inventory</mat-icon>
          Productos
        </a>
        
        <a mat-button routerLink="/bar/ventas" (click)="closeSidenavPanel()" class="nav-link bar-link">
          <mat-icon>point_of_sale</mat-icon>
          Ventas
        </a>
      }

      <!-- Enlaces específicos para roles de Estacionamiento -->
      @if (canAccessEstacionamiento()) {
        <mat-divider></mat-divider>
        <div class="section-header">
          <mat-icon>local_parking</mat-icon>
          Gestión de Estacionamiento
        </div>
        
        <a mat-button routerLink="/estacionamiento/espacios" (click)="closeSidenavPanel()" class="nav-link parking-link">
          <mat-icon>garage</mat-icon>
          Espacios
        </a>
        
        <a mat-button routerLink="/estacionamiento/reservas" (click)="closeSidenavPanel()" class="nav-link parking-link">
          <mat-icon>event_available</mat-icon>
          Reservas de Estacionamiento
        </a>
      }
    }
  </div>
</nav>
